(leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2"))
(leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2"))
(leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2"))
(leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2"))
(leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2"))
leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2"))
(leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2"))
leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2")
sum((leitosNH %>% filter(trimws(CO_TIPO_LEITO) == "2"))$QT_SUS)
sum((leitosNH %>% filter(trimws(CO_TIPO_LEITO) == "2"), trimws(CO_TIPO_LEITO) == "1"))$QT_SUS)
sum((leitosNH %>% filter(trimws(CO_TIPO_LEITO) == "2", trimws(CO_TIPO_LEITO) == "1"))$QT_SUS)
sum((leitosNH %>% filter(trimws(CO_TIPO_LEITO) == "2" || trimws(CO_TIPO_LEITO) == "1"))$QT_SUS)
sum((leitosNH %>% filter(trimws(CO_TIPO_LEITO) == "2" || trimws(CO_TIPO_LEITO) == "1"))$QT_SUS)
sum((leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2")))$QT_SUS)
sum((leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2")))$QT_SUS)
sum((leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2")))$QT_SUS)
sum((leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_SUS)
sum((leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_SUS)
total <- sum((leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_EXIST)
total
totalSus <- sum((leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_SUS)
totalSus
total - totalSus
totalSus
total - totalSus
total
totalSus
(leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7"))
(leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")
(leitosNH %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))
leitosNH
leitosNH
det <- leitosNH %>% inner_join(codigosLeitos, by = c("CO_LEITO" = "CO_LEITO")) %>% select(QT_SUS, DS_LEITO)
det
det <- leitosNH %>% inner_join(codigosLeitos, by = c("CO_LEITO" = "CO_LEITO")) %>% select(QT_CONTR, QT_SUS, DS_LEITO)
det
det <- leitosNH %>% inner_join(codigosLeitos, by = c("CO_LEITO" = "CO_LEITO")) %>% select(QT_EXIST, QT_SUS, DS_LEITO)
det
leitosNH
leitosNH
estabelecimentos
select(estabelecimentos, NO_RAZAO_SOCIAL)
estabelecimentos
select(estabelecimentos, CO_UNIDADE, NO_RAZAO_SOCIAL)
leitosNH %>% inner_join(select(estabelecimentos, CO_UNIDADE, NO_RAZAO_SOCIAL), by = c("CO_UNIDADE"))
estabelecimentos
leitosNH %>% inner_join(select(estabelecimentos, CO_UNIDADE, NO_FANTASIA), by = c("CO_UNIDADE"))
leitosNH %>% inner_join(select(estabelecimentos, CO_UNIDADE, NO_FANTASIA), by = c("CO_UNIDADE"))
leitosNH %>% inner_join(select(estabelecimentos, CO_UNIDADE, NO_FANTASIA), by = c("CO_UNIDADE"))
leitosNH <- leitosNH %>% inner_join(select(estabelecimentos, CO_UNIDADE, NO_FANTASIA), by = c("CO_UNIDADE"))
leitosNH <- leitosNH %>% inner_join(select(estabelecimentos, CO_UNIDADE, NO_FANTASIA), by = c("CO_UNIDADE"))
leitosNH %>% inner_join(codigosLeitos, by = c("CO_LEITO" = "CO_LEITO")) %>% select(QT_EXIST, QT_SUS, DS_LEITO)
leitosNH %>% inner_join(codigosLeitos, by = c("CO_LEITO" = "CO_LEITO")) %>% select(NO_FANTASIA, QT_EXIST, QT_SUS, DS_LEITO)
leitosNH <- leitosNH %>% inner_join(select(estabelecimentos, CO_UNIDADE, NO_FANTASIA), by = c("CO_UNIDADE"))
leitosNH
leitosNH <- leitos %>% filter(CO_UNIDADE %in% (estabelecimentos %>% filter(CO_CEP > 93300001, CO_CEP < 93599999))$CO_UNIDADE)
leitosNH <- leitosNH %>% inner_join(select(estabelecimentos, CO_UNIDADE, NO_FANTASIA), by = c("CO_UNIDADE"))
leitosNH
leitosNH %>% inner_join(codigosLeitos, by = c("CO_LEITO" = "CO_LEITO")) %>% select(NO_FANTASIA, QT_EXIST, QT_SUS, DS_LEITO)
leitosNH
estabNH <- estabelecimentos %>% filter(CO_CEP > 93300001, CO_CEP < 93599999)
estabNH
fread("tbTipoUnidade202101.csv")
tipoUnidade <- fread("tbTipoUnidade202101.csv")
estabNH <- estabelecimentos %>% filter(CO_CEP > 93300001, CO_CEP < 93599999)
estabNH
tipoUnidade
estabNH <- estabelecimentos %>% filter(CO_CEP > 93300001, CO_CEP < 93599999)
leitosNH <- leitosNH %>% inner_join(select(estabNH, CO_UNIDADE, NO_FANTASIA, TP_UNIDADE), by = c("CO_UNIDADE"))
leitosNH <- leitos %>% filter(CO_UNIDADE %in% (estabelecimentos %>% filter(CO_CEP > 93300001, CO_CEP < 93599999))$CO_UNIDADE)
leitosNH <- leitos %>% filter(CO_UNIDADE %in% (estabNH)$CO_UNIDADE)
leitosNH <- leitosNH %>% inner_join(select(estabNH, CO_UNIDADE, NO_FANTASIA, TP_UNIDADE), by = c("CO_UNIDADE"))
leitosNH
tipoUnidade
leitosNH
estabelecimentos <- fread("tbEstabelecimento202101.csv")
leitos <- fread("rlEstabComplementar202101.csv")
estabMunicipio <- estabelecimentos %>% filter(CO_CEP > 95860000, CO_CEP < 95862999) #TAQUARI
leitosMunicipio <- leitos %>% filter(CO_UNIDADE %in% (estabMunicipio)$CO_UNIDADE)
leitosMunicipio
total <- sum((leitosMunicipio %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_EXIST)
totalSus <- sum((leitosMunicipio %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_SUS)
total - totalSus
totalSus
leitosMunicipio
leitosTk <- leitosMunicipio %>% inner_join(select(estabNH, CO_UNIDADE, NO_FANTASIA, TP_UNIDADE), by = c("CO_UNIDADE"))
leitosTk
leitosMunicipio %>% inner_join(select(estabMunicipio, CO_UNIDADE, NO_FANTASIA, TP_UNIDADE), by = c("CO_UNIDADE"))
leitosNH %>% inner_join(codigosLeitos, by = c("CO_LEITO" = "CO_LEITO")) %>% select(NO_FANTASIA, QT_EXIST, QT_SUS, DS_LEITO)
leitosMunicipio %>% inner_join(codigosLeitos, by = c("CO_LEITO" = "CO_LEITO")) %>% select(NO_FANTASIA, QT_EXIST, QT_SUS, DS_LEITO)
leitosTk <- leitosMunicipio %>% inner_join(select(estabMunicipio, CO_UNIDADE, NO_FANTASIA, TP_UNIDADE), by = c("CO_UNIDADE"))
leitosTk %>% inner_join(codigosLeitos, by = c("CO_LEITO" = "CO_LEITO")) %>% select(NO_FANTASIA, QT_EXIST, QT_SUS, DS_LEITO)
total
totalSus
total - totalSus
total <- sum((leitosMunicipio %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_EXIST)
read.csv2("DADOS/escolas.CSV")
read.csv2("DADOS/escolas.CSV", sep = "|")
estabMunicipio <- estabelecimentos %>% filter(CO_CEP > 90000001, CO_CEP < 91999999)
leitosMunicipio <- leitos %>% filter(CO_UNIDADE %in% (estabMunicipio)$CO_UNIDADE)
sum((leitosMunicipio %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_EXIST)
sum((leitosMunicipio %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_SUS)
leitosMunicipio
leitosMunicipio %>% inner_join(select(estabMunicipio, CO_UNIDADE, NO_FANTASIA, TP_UNIDADE), by = c("CO_UNIDADE"))
escolas <- read.csv2("DADOS/escolas.CSV", sep = "|")
estabMunicipio <- estabelecimentos %>% filter(CO_CEP > 95860000, CO_CEP < 95862999) #TAQUARI
leitosMunicipio <- leitos %>% filter(CO_UNIDADE %in% (estabMunicipio)$CO_UNIDADE)
sum((leitosMunicipio %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_EXIST)
estabMunicipio <- estabelecimentos %>% filter(CO_CEP > 93300001, CO_CEP < 93599999) #NOVO HAMBURGO
leitosMunicipio <- leitos %>% filter(CO_UNIDADE %in% (estabMunicipio)$CO_UNIDADE)
sum((leitosMunicipio %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_EXIST)
sum((leitosMunicipio %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_SUS)
total - totalSus
total <- sum((leitosMunicipio %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_EXIST)
totalSus <- sum((leitosMunicipio %>% filter(trimws(CO_TIPO_LEITO) %in% c("1","2", "4", "5", "6", "7")))$QT_SUS)
total - totalSus
totalSus
estabMunicipio
leitosMunicipio
leitosMunicipio %>% inner_join(select(estabMunicipio, CO_UNIDADE, NO_FANTASIA, TP_UNIDADE), by = c("CO_UNIDADE"))
library("dplyr")
readxl::read_excel(path = "TABMUN-SIAFI.xlsx")
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx")
municipiosSIAFI
readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
municipiosSIAFI
municipiosIBGE <- readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
municipiosIBGE
municipiosSIAFI
municipiosIBGE
municipiosSIAFI
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("Código Município Completo", "CÓDIGO IBGE"))
municipiosIBGE
municipiosSIAFI
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("Código Município Completo", "CÓDIGO IBGE"))
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("CÓDIGO IBGE", "Código Município Completo"))
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("Código Município Completo"))
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx")
municipiosIBGE <- readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
municipiosSIAFI
municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(CODIGO_SIAFI = `CÓDIGO SIAFI`, CODIGO_IBGE = `CÓDIGO IBGE`)
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx")
municipiosSIAFI <- municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(CODIGO_SIAFI = `CÓDIGO SIAFI`, CODIGO_IBGE = `CÓDIGO IBGE`)
readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
municipiosIBGE %>% filter(Nome_Município == "Novo Hamburgo")
readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
names(municipiosIBGE)
tolower(names(municipiosIBGE))
gsub(" ", "_", tolower(names(municipiosIBGE)))
gsub(" ", "_", tolower(names(municipiosIBGE)))
setNames(gsub(" ", "_", tolower(names(municipiosIBGE))))
colnames(municipiosIBGE) <- setNames(gsub(" ", "_", tolower(names(municipiosIBGE))))
gsub(" ", "_", tolower(names(municipiosIBGE))
gsub(" ", "_", tolower(names(municipiosIBGE))
tolower(names(municipiosIBGE))
gsub(" ", "_", tolower(names(municipiosIBGE)))
gsub(" ", "_", tolower(names(municipiosIBGE)))
gsub(" ", "_", tolower(names(municipiosIBGE)))
gsub(" ", "_", tolower(names(municipiosIBGE)))
gsub(" ", "_", tolower(names(municipiosIBGE)))
colnames(municipiosIBGE) <- gsub(" ", "_", tolower(names(municipiosIBGE)))
municipiosIBGE
municipiosIBGE <- readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
colnames(municipiosIBGE) <- gsub(" ", "_", tolower(names(municipiosIBGE)))
municipiosIBGE
estadosIBGE <- municipiosIBGE %>% select(uf, nome_uf)
estadosIBGE
municipiosIBGE
municipiosIBGE %>% filter(Nome_Município == "Novo Hamburgo")
municipiosIBGE %>% filter(nome_município == "Novo Hamburgo")
municipiosIBGE %>% filter(nome_município == "Taquara")
municipiosIBGE %>% select(uf, nome_uf, nome_mesorregião, nome_microrregião, município, código_município_completo, nome_município)
municipiosIBGE %>% select(uf, nome_uf)
unique(municipiosIBGE %>% select(uf, nome_uf))
municipiosIBGE %>% select(uf, nome_uf, nome_mesorregião, nome_microrregião, município, código_município_completo, nome_município)
municipiosIBGE %>% select(uf, nome_uf, nome_mesorregião, nome_microrregião, nome_município, município, código_município_completo)
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo)
municipiosIBGE %>% select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo)
municipiosIBGE %>%
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo) %>%
rename(nome_mesorregiao = nome_mesorregião,
nome_microrregiao = nome_microrregião,
nome_municpio = nome_município,
codigo_ibge_municipio = município,
codigo_ibge_estado = uf,
codigo_ibge = código_município_completo
)
municipiosIBGE %>%
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo) %>%
rename(nome_mesorregiao = nome_mesorregião,
nome_microrregiao = nome_microrregião,
nome_municpio = nome_município,
codigo_ibge_municipio = município,
codigo_ibge_uf = uf,
codigo_ibge = código_município_completo
)
municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(codigo_siafi = `CÓDIGO SIAFI`, codigo_ibge = `CÓDIGO IBGE`)
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx")
municipiosSIAFI
municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`)
municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(codigo_siafi = `CÓDIGO SIAFI`, codigo_ibge = `CÓDIGO IBGE`)
municipiosSIAFI <- municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(codigo_siafi = `CÓDIGO SIAFI`, codigo_ibge = `CÓDIGO IBGE`)
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge", "codigo_ibge"))
municipiosIBGE
#estadosIBGE <- unique(municipiosIBGE %>% select(uf, nome_uf))
municipiosIBGE <- municipiosIBGE %>%
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo) %>%
rename(nome_mesorregiao = nome_mesorregião,
nome_microrregiao = nome_microrregião,
nome_municpio = nome_município,
codigo_ibge_municipio = município,
codigo_ibge_uf = uf,
codigo_ibge = código_município_completo
)
municipiosIBGE
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge", "codigo_ibge"))
municipiosIBGE
municipiosSIAFI
unique(codigo_ibge)
unique(municipiosSIAFI)
municipiosIBGE
municipiosIBGE
municipiosSIAFI
municipiosIBGE
municipiosSIAFI
municipiosSIAFI$codigo_ibge
unique(municipiosSIAFI$codigo_ibge)
length(unique(municipiosSIAFI$codigo_ibge))
municipiosIBGE
municipiosSIAFI <- unique(municipiosSIAFI$codigo_ibge)
municipiosSIAFI
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx")
municipiosSIAFI <- municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(codigo_siafi = `CÓDIGO SIAFI`, codigo_ibge = `CÓDIGO IBGE`)
municipiosSIAFI
municipiosSIAFI %>% group_by(codigo_ibge) %>% summarise(qtd = n())
municipiosSIAFI %>% filter(codigo_ibge = 0000000)
municipiosSIAFI %>% filter(codigo_ibge = 0000000)
municipiosSIAFI %>% filter(codigo_ibge == 0000000)
municipiosSIAFI %>% filter(codigo_ibge == "0000000")
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx") %>% filter(`CÓDIGO IBGE` != "0000000")
municipiosSIAFI
municipiosSIAFI <- municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(codigo_siafi = `CÓDIGO SIAFI`, codigo_ibge = `CÓDIGO IBGE`)
municipiosIBGE <- readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
colnames(municipiosIBGE) <- gsub(" ", "_", tolower(names(municipiosIBGE)))
municipiosIBGE <- municipiosIBGE %>%
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo) %>%
rename(nome_mesorregiao = nome_mesorregião,
nome_microrregiao = nome_microrregião,
nome_municpio = nome_município,
codigo_ibge_municipio = município,
codigo_ibge_uf = uf,
codigo_ibge = código_município_completo
)
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge", "codigo_ibge"))
municipiosIBGE
municipiosSIAFI
municipiosIBGE
municipiosSIAFI
municipiosSIAFI %>% group_by(codigo_ibge) %>% summarise(total = n())
municipiosSIAFI %>% group_by(codigo_ibge) %>% summarise(total = n()) %>% filter(total > 1)
municipiosIBGE %>% group_by(codigo_ibge) %>% summarise(total = n()) %>% filter(total > 1)
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge", "codigo_ibge"))
municipiosSIAFI %>% group_by(codigo_ibge) %>% summarise(total = n())
municipiosIBGE %>% group_by(codigo_ibge) %>% summarise(total = n())
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge", "codigo_ibge"))
municipiosSIAFI
municipiosIBGE
municipiosIBGE %>% left_join(municipiosSIAFI, by = c("codigo_ibge", "codigo_ibge"))
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge", "codigo_ibge"))
municipiosSIAFI
unique(municipiosSIAFI$codigo_ibge)
length(unique(municipiosSIAFI$codigo_ibge))
length(unique(municipiosIBGE$codigo_ibge))
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx") %>% filter(`CÓDIGO IBGE` != "0000000")
municipiosSIAFI <- municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(codigo_siafi = `CÓDIGO SIAFI`, codigo_ibge = `CÓDIGO IBGE`)
municipiosIBGE <- readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
colnames(municipiosIBGE) <- gsub(" ", "_", tolower(names(municipiosIBGE)))
municipiosIBGE <- municipiosIBGE %>%
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo) %>%
rename(nome_mesorregiao = nome_mesorregião,
nome_microrregiao = nome_microrregião,
nome_municpio = nome_município,
codigo_ibge_municipio = município,
codigo_ibge_uf = uf,
codigo_ibge = código_município_completo
)
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge", "codigo_ibge"))
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx") %>% filter(`CÓDIGO IBGE` != "0000000")
municipiosSIAFI <- municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(codigo_siafi = `CÓDIGO SIAFI`, codigo_ibge = `CÓDIGO IBGE`)
municipiosIBGE <- readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
colnames(municipiosIBGE) <- gsub(" ", "_", tolower(names(municipiosIBGE)))
municipiosIBGE <- municipiosIBGE %>%
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo) %>%
rename(nome_mesorregiao = nome_mesorregião,
nome_microrregiao = nome_microrregião,
nome_municpio = nome_município,
codigo_ibge_municipio = município,
codigo_ibge_uf = uf,
codigo_ibge_2 = código_município_completo
)
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge_2", "codigo_ibge"))
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge_2", "codigo_ibge1"))
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge_2", "codigo_ibge1"))
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge_2", "codigo_ibge1"))
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge_2", "codigo_ibge"))
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge_2", "codigo_ibge"))
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge_2", "codigo_ibge"))
municipiosIBGE
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge", "codigo_ibge_2"))
municipiosSIAFI
municipiosIBGE
municipiosSIAFI
municipiosSIAFI$codigo_ibge
union_all(municipiosSIAFI$codigo_ibge, municipiosIBGE$codigo_ibge)
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx") %>% filter(`CÓDIGO IBGE` != "0000000")
municipiosSIAFI <- municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(codigo_siafi = `CÓDIGO SIAFI`, codigo_ibge = `CÓDIGO IBGE`)
municipiosIBGE <- readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
colnames(municipiosIBGE) <- gsub(" ", "_", tolower(names(municipiosIBGE)))
municipiosIBGE <- municipiosIBGE %>%
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo) %>%
rename(nome_mesorregiao = nome_mesorregião,
nome_microrregiao = nome_microrregião,
nome_municpio = nome_município,
codigo_ibge_municipio = município,
codigo_ibge_uf = uf,
codigo_ibge_2 = código_município_completo
)
union_all(municipiosSIAFI$codigo_ibge, municipiosIBGE$codigo_ibge)
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx") %>% filter(`CÓDIGO IBGE` != "0000000")
municipiosSIAFI <- municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(codigo_siafi = `CÓDIGO SIAFI`, codigo_ibge = `CÓDIGO IBGE`)
municipiosIBGE <- readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
colnames(municipiosIBGE) <- gsub(" ", "_", tolower(names(municipiosIBGE)))
municipiosIBGE <- municipiosIBGE %>%
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo) %>%
rename(nome_mesorregiao = nome_mesorregião,
nome_microrregiao = nome_microrregião,
nome_municpio = nome_município,
codigo_ibge_municipio = município,
codigo_ibge_uf = uf,
codigo_ibge = código_município_completo
)
union_all(municipiosSIAFI$codigo_ibge, municipiosIBGE$codigo_ibge)
distinct(municipiosSIAFI$codigo_ibge, municipiosIBGE$codigo_ibge)
distinct_all(municipiosSIAFI$codigo_ibge, municipiosIBGE$codigo_ibge)
municipiosSIAFI$codigo_ibge %in% municipiosIBGE$codigo_ibge
municipiosIBGE$codigo_ibge %in% municipiosSIAFI$codigo_ibge
!(municipiosIBGE$codigo_ibge %in% municipiosSIAFI$codigo_ibge)
municipiosIBGE %>% inner_join(municipiosSIAFI, by = c("codigo_ibge", "codigo_ibge"))
municipiosIBGE %>% inner_join(municipiosSIAFI)
municipiosIBGE %>% inner_join(municipiosSIAFI)
municipios <- municipiosIBGE %>% inner_join(municipiosSIAFI)
municipios
typeof municipios$nome_uf
data_types(municipios$nome_uf)
municipios <- municipiosIBGE %>% inner_join(municipiosSIAFI)
municipios
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx") %>% filter(`CÓDIGO IBGE` != "0000000")
municipiosSIAFI <- municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(codigo_siafi = `CÓDIGO SIAFI`, codigo_ibge = `CÓDIGO IBGE`)
municipiosIBGE <- readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
colnames(municipiosIBGE) <- gsub(" ", "_", tolower(names(municipiosIBGE)))
municipiosIBGE <- municipiosIBGE %>%
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo) %>%
rename(nome_mesorregiao = nome_mesorregião,
nome_microrregiao = nome_microrregião,
nome_municpio = nome_município,
codigo_ibge_municipio = município,
codigo_ibge_uf = uf,
codigo_ibge = código_município_completo
)
municipios <- municipiosIBGE %>% inner_join(municipiosSIAFI)
write.csv(municipios, "municipios.csv", na = "", row.names = FALSE)
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx") %>% filter(`CÓDIGO IBGE` != "0000000")
municipiosSIAFI <- municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(codigo_siafi = `CÓDIGO SIAFI`, codigo_ibge = `CÓDIGO IBGE`)
municipiosIBGE <- readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
colnames(municipiosIBGE) <- gsub(" ", "_", tolower(names(municipiosIBGE)))
municipiosIBGE <- municipiosIBGE %>%
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo) %>%
rename(nome_mesorregiao = toupper(nome_mesorregião),
nome_microrregiao = toupper(nome_microrregião),
nome_municpio = toupper(nome_município),
codigo_ibge_municipio = toupper(município),
codigo_ibge_uf = uf,
codigo_ibge = código_município_completo
)
municipiosIBGE %>%
select(nome_uf, nome_mesorregião, toupper(nome_microrregião), nome_município, uf, município, código_município_completo)
municipiosIBGE %>%
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo) %>%
rename(nome_mesorregiao = nome_mesorregião,
nome_microrregiao = nome_microrregião,
nome_municipio = nome_município,
codigo_ibge_municipio = município,
codigo_ibge_uf = uf,
codigo_ibge = código_município_completo
) %>% mutate(nome_municipio = toupper(nome_municipio))
municipiosSIAFI <- readxl::read_excel(path = "TABMUN-SIAFI.xlsx") %>% filter(`CÓDIGO IBGE` != "0000000")
municipiosSIAFI <- municipiosSIAFI %>% select(`CÓDIGO SIAFI`, `CÓDIGO IBGE`) %>% rename(codigo_siafi = `CÓDIGO SIAFI`, codigo_ibge = `CÓDIGO IBGE`)
municipiosIBGE <- readxl::read_excel("RELATORIO_DTB_BRASIL_MUNICIPIO.xls")
colnames(municipiosIBGE) <- gsub(" ", "_", tolower(names(municipiosIBGE)))
municipiosIBGE <- municipiosIBGE %>%
select(nome_uf, nome_mesorregião, nome_microrregião, nome_município, uf, município, código_município_completo) %>%
rename(nome_mesorregiao = nome_mesorregião,
nome_microrregiao = nome_microrregião,
nome_municipio = nome_município,
codigo_ibge_municipio = município,
codigo_ibge_uf = uf,
codigo_ibge = código_município_completo
) %>% mutate(nome_municipio = toupper(nome_municipio))
municipios <- municipiosIBGE %>% inner_join(municipiosSIAFI)
write.csv(municipios, "municipios.csv", na = "", row.names = FALSE)
write.csv(municipios, "municipios.csv", na = "", row.names = FALSE)
municipios
read.csv2("br-city-codes.csv")
read.csv2("br-city-codes.csv", sep = ";")
read.csv2("br-city-codes.csv", sep = ",")
read.csv2("br-city-codes.csv", sep = ",", encoding = "UTF-8")
read.csv2("br-city-codes.csv", sep = ",", encoding = "UTF-8") %>% select(idIBGE, postalCode_ranges)
faixaCeps <- read.csv2("br-city-codes.csv", sep = ",", encoding = "UTF-8") %>% select(idIBGE, postalCode_ranges)
faixaCeps
faixaCeps
gsub("[", "", faixaCeps$postalCode_ranges)
gsub("\[", "", faixaCeps$postalCode_ranges)
gsub("/[", "", faixaCeps$postalCode_ranges)
gsub("\[\", "", faixaCeps$postalCode_ranges)
gsub("[\", "", faixaCeps$postalCode_ranges)
gsub('\[', "", faixaCeps$postalCode_ranges)
gsub('[', "", faixaCeps$postalCode_ranges)
faixaCeps$postalCode_ranges
gsub('-', "", faixaCeps$postalCode_ranges)
gregexpr('[0-9]+','[38540000 38549999]')
library("jsonlite")
fromJSON(faixaCeps$postalCode_ranges)
gsub(' ', ",", faixaCeps$postalCode_ranges)
fromJSON(gsub(' ', ",", faixaCeps$postalCode_ranges))
faixaCeps$postalCode_ranges
gsub("-", "", gsub(' ', ",", faixaCeps$postalCode_ranges))
fromJSON(gsub("-", "", gsub(' ', ",", faixaCeps$postalCode_ranges)))
(gsub("-", "", gsub(' ', ",", faixaCeps$postalCode_ranges)))[1]
fromJSON((gsub("-", "", gsub(' ', ",", faixaCeps$postalCode_ranges)))[1])
fromJSON((gsub("-", "", gsub(' ', ",", faixaCeps$postalCode_ranges)))[1])
fromJSON((gsub("-", "", gsub(' ', ",", faixaCeps$postalCode_ranges)))[1])
fromJSON((gsub("-", "", gsub(' ', ",", faixaCeps$postalCode_ranges)))[2])
fromJSON((gsub("-", "", gsub(' ', ",", faixaCeps$postalCode_ranges)))[1:10])
faixaCeps %>% mutate(postalCode_ranges = fromJSON(gsub("-", "", gsub(' ', ",", postalCode_ranges))))
gsub("[^[:alnum:] ]", "", faixaCeps$postalCode_ranges)
gsub("[^[:alnum:] ]", "", faixaCeps$postalCode_ranges)
feixaCeps %>% mutate(postalCode_ranges = fromJSON((gsub("-", "", gsub(' ', ",", postalCode_ranges)))))
faixaCeps %>% mutate(postalCode_ranges = fromJSON((gsub("-", "", gsub(' ', ",", postalCode_ranges)))))
faixaCeps %>% mutate(postalCode_ranges = gsub("[^[:alnum:] ]", "", postalCode_ranges))
faixaCeps %>% mutate(postalCode_ranges = gsub("[^[:alnum:] ]", "", postalCode_ranges)) %>% rename(codigo_ibge = idIBGE)
faixaCeps <- read.csv2("br-city-codes.csv", sep = ",", encoding = "UTF-8") %>% select(idIBGE, postalCode_ranges)
faixaCeps <- faixaCeps %>% mutate(postalCode_ranges = gsub("[^[:alnum:] ]", "", postalCode_ranges)) %>% rename(codigo_ibge = idIBGE)
faixaCeps
strsplit(faixaCeps$postalCode_ranges, " ")[[1]]
scan(faixaCeps$postalCode_range, "")
scan(text = faixaCeps$postalCode_range, what = "")
library("tidyr")
faixaCeps %>% separate(postalCode_ranges, c("cep_start", "cep_end"))
faixaCeps %>% separate(postalCode_ranges, c("cep_inicio", "cep_fim"))
faixaCeps <- faixaCeps %>% separate(postalCode_ranges, c("cep_inicio", "cep_fim"))
faixaCeps <- read.csv2("br-city-codes.csv", sep = ",", encoding = "UTF-8") %>% select(idIBGE, postalCode_ranges)
faixaCeps <- faixaCeps %>% mutate(postalCode_ranges = gsub("[^[:alnum:] ]", "", postalCode_ranges)) %>% rename(codigo_ibge = idIBGE)
faixaCeps <- faixaCeps %>% separate(postalCode_ranges, c("cep_inicio", "cep_fim"))
faixaCeps
##CEPS
faixaCeps <- read.csv2("br-city-codes.csv", sep = ",", encoding = "UTF-8") %>% select(idIBGE, postalCode_ranges)
faixaCeps <- faixaCeps %>% mutate(postalCode_ranges = gsub("[^[:alnum:] ]", "", postalCode_ranges)) %>% rename(codigo_ibge = idIBGE)
faixaCeps <- faixaCeps %>% separate(postalCode_ranges, c("inicio_cep", "fim_cep"))
faixaCeps
write.csv(faixaCeps, "ceps", na = "", row.names = FALSE)
write.csv(faixaCeps, "output/ceps.csv", na = "", row.names = FALSE)
faixaCeps
list.files("download")
getwd()
dirname(sys.frame(1)$ofile)
sys.frame(1)
library(here)
install.packages(here)
install.packages("here")
library(here)
here()
here()
here("process.R")
setwd("D:/Projetos/TCC/Datasets_Final/Transferencias")
list.files("download")
files <- list.files("download")
write.csv2(transferencias, "output/transferencias.csv", row.names = FALSE, na = "")
library(dplyr)
library(here)
files <- list.files("download")
transferencias <- read.csv2(paste("download/", files[1], sep = "")) %>%
mutate(ANO = substr(ANO...MÊS, 1, 4), MES = substr(ANO...MÊS, 5, 6)) %>%
select(-ANO...MÊS, -NOME.MUNICÍPIO)
for(file in tail(files, -1)) {
aux <- read.csv2(paste("download/", file, sep = "")) %>%
mutate(ANO = substr(ANO...MÊS, 1, 4), MES = substr(ANO...MÊS, 5, 6)) %>%
select(-ANO...MÊS, -NOME.MUNICÍPIO)
aux <- aux %>% filter(!is.na(CÓDIGO.MUNICÍPIO.SIAFI))
transferencias <- rbind(aux, transferencias)
}
transferencias <- transferencias %>% select(ANO, MES, CÓDIGO.MUNICÍPIO.SIAFI, TIPO.TRANSFERÊNCIA, TIPO.FAVORECIDO, NOME.FUNÇÃO, NOME.PROGRAMA, VALOR.TRANSFERIDO)
transferencias <- setNames(transferencias, c("ano", "mes", "codigo_siafi", "tipo_transferencia", "tipo_favorecido", "nome_funcao", "nome_programa",  "valor_transferido"))
transferencias$valor_transferido <- sub(",",".",transferencias$valor_transferido)
transferencias <- transferencias %>% mutate(tipo_transferencia = case_when(
tipo_transferencia == 'Legais, Voluntárias e Específicas' ~ 1,
tipo_transferencia == 'Constitucionais e Royalties' ~ 2
))
write.csv2(transferencias, "output/transferencias.csv", row.names = FALSE, na = "")
install.packages(c("dplyr"))
install.packages(c("dplyr"))
install.packages(c("dplyr", "stringr"))
install.packages(c("dplyr", "stringr"))
